---
title: "L4P1: Regressão com parlamentares"
author: "Alice Fernandes Silva"
output:
    html_document:
    df_print: paged
theme: sandstone
---

```{r warning = FALSE, message = FALSE, error = FALSE, echo = FALSE}
library(broom)
library(here)
library(ggbeeswarm)
library(ggplot2)
library(gridExtra)
library(modelr)
library(tidyverse)
source(here("code/lib.R"))
options(scipen = 999)
theme_set(theme_bw())
```

```{r read}
atividade = read_projectdata()

atividade = atividade %>% 
  na.omit(.) %>%
  filter(partido != "S/ Partido") %>%
  filter(seguidores > 0, n_proprio > 0, n_retweet > 0)  %>%
  filter(engaj_total > 0, engaj_mediano > 0)

atividade <- atividade %>% 
  mutate(casa = if_else(casa == "senado", "Senado", "Câmara"))

glimpse(atividade)

```
### 1 — Qual a relação entre as características da atuação do parlamentar e o engajamento total que ele obtém no Twitter?

## Realizano uma análise linear entre as variáveis

### Casa do Congresso

```{r}
atividade %>% 
  ggplot(aes(x = casa, y = engaj_total)) + 
  geom_quasirandom(size = 2, alpha = .7, colour = "orange") +
  scale_y_log10()
```

### Número de Perfis Seguidos

```{r}
atividade %>% 
  ggplot(aes(x = segue, y = engaj_total)) + 
  geom_point(size = 2, alpha = .7, colour = "orange") +
  scale_x_log10() +
  scale_y_log10()
```

### Número de Seguidores

```{r warning = FALSE, message = FALSE, error = FALSE, fig.height = 7.5, fig.width = 7.5}
atividade %>% 
  ggplot(aes(x = seguidores, y = engaj_total)) + 
  geom_point(size = 2, alpha = .7, colour = "orange") +
  scale_x_log10() +
  scale_y_log10()
```

### Número de *Tweets*

```{r}
atividade%>% 
  ggplot(aes(x = n_proprio, y = engaj_total)) + 
  geom_point(size = 2, alpha = .7, colour = "orange") +
  scale_x_log10() +
  scale_y_log10()
```

### Número de *Retweets*

```{r}
atividade %>% 
  ggplot(aes(x = n_retweet, y = engaj_total)) + 
  geom_point(size = 2, alpha = .7, colour = "orange") +
  scale_x_log10() +
  scale_y_log10()
```

## Análises

```{r}
atividade <- atividade %>% 
  mutate(segue_log = log10(segue),
         seguidores_log = log10(seguidores), 
         n_proprio_log = log10(n_proprio),
         n_retweet_log = log10(n_retweet),
         engaj_total_log = log10(engaj_total))
```


```{r}
modelo <- lm(engaj_total_log ~ casa + segue_log + seguidores_log + n_proprio_log + n_retweet_log,
                   data = atividade)
tidy(modelo)
glance(modelo)
```

Com base nos resultados da regressão linear múltipla acima, as variáveis analisadas se relacionam através de um modelo com formato **log(ET) = - 0,66(casaSenado) - 3,85log(segue_log) + 9,95log(seguidores_log) + 5,34log(n_proprio_log) + 11,60log(n_retweet_log) + 2,08** que explica **71,61%** da variância da variável independente (R² = 0,7161578).

### 2. Qual a relação entre as características da atuação do parlamentar e o *engajamento mediano* que ele obtém no twitter? 
## Realizano uma análise linear entre as variáveis

### Casa do Congresso

```{r}
atividade %>% 
  ggplot(aes(x = casa, y = engaj_mediano)) + 
  geom_quasirandom(size = 2, alpha = .7, colour = "red") +
  scale_y_log10()
```

### Número de Perfis Seguidos

```{r}
atividade %>% 
  ggplot(aes(x = segue, y = engaj_mediano)) + 
  geom_point(size = 2, alpha = .7, colour = "red") +
  scale_x_log10() +
  scale_y_log10()
```

### Número de Seguidores

```{r warning = FALSE, message = FALSE, error = FALSE, fig.height = 7.5, fig.width = 7.5}
atividade %>% 
  ggplot(aes(x = seguidores, y = engaj_mediano)) + 
  geom_point(size = 2, alpha = .7, colour = "red") +
  scale_x_log10() +
  scale_y_log10()
```

### Número de *Tweets*

```{r}
atividade%>% 
  ggplot(aes(x = n_proprio, y = engaj_mediano)) + 
  geom_point(size = 2, alpha = .7, colour = "red") +
  scale_x_log10() +
  scale_y_log10()
```

### Número de *Retweets*

```{r}
atividade %>% 
  ggplot(aes(x = n_retweet, y = engaj_mediano)) + 
  geom_point(size = 2, alpha = .7, colour = "red") +
  scale_x_log10() +
  scale_y_log10()
```

## Análises

```{r}
atividade <- atividade %>% 
  mutate(engaj_mediano_log = log10(engaj_mediano))
```


```{r}
modelo <- lm(engaj_mediano_log ~ casa + segue_log + seguidores_log + n_proprio_log + n_retweet_log,
                   data = atividade)
tidy(modelo)
glance(modelo)
```

Com base nos resultados da regressão linear múltipla acima, as variáveis analisadas se relacionam através de um modelo com formato **engaj_mediano_log = - 1.24(casaSenado) - 5.57(segue_log) + 16.10(seguidores_log) -1.83(n_proprio_log) + 4,66(n_retweet_log) -3.79** que explica **57,28%** da variância da variável independente (R² = 0.5728301).
